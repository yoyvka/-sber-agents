# Проект: AI-помощник дпо подготовке и согласованию управленческих корректировок (Management Adjustment Assistant)

## Описание проекта

**Проблема**: Значительный процент заявок на корректировки отклоняется из-за типовых, повторяющихся ошибок: неполное обоснование, отсутствие необходимых документов, нарушение внутренних регламентов. Это приводит к потере времени сотрудников и согласующих, а также к задержкам в отчетности.

**Решение**: AI-агент, который выступает в роли "умного рецензента" на этапе подготовки заявки, предотвращая типовые ошибки на основе анализа исторических данных.
Анализирует базу знаний об ранее отклоненных заявках и помогает авторам:
- Заранее выявлять потенциальные причины отклонения
- Формировать заявки с учетом успешных паттернов прошлого
- Предоставлять рекомендации по улучшению формулировок и обоснований

**Ценность**: Сокращение времени согласования, повышение качества заявок, снижение количества итераций.

## Целевая аудитория

1. **Основные пользователи**: 
   - Менеджеры и аналитики, подготавливающие заявки на управленческие корректировки
   - Сотрудники финансового департамента

2. **Косвенные пользователи**:
   - Согласующие лица (руководители направлений)
   - Администраторы системы управленческой отчетности

## Основные функции и возможности

1.  **Интеллектуальный анализ заявки:** Прием свободного текстового описания корректировки от пользователя.
2.  **Структурирование запроса:** Автоматическое извлечение ключевых параметров из текста (сумма, статья затрат, подразделение, контрагент, тип операции).
3.  **Поиск релевантного опыта (RAG):** Поиск в базе знаний исторически отклоненных и согласованных заявок, схожих по параметрам с текущей.
4.  **Генерация рекомендаций:** Формирование списка потенциальных рисков отклонения, предложений по улучшению текста обоснования и чек-листа необходимых документов.
5.  **Интерактивный режим (агент):** Возможность задать помощнику уточняющие вопросы по его рекомендациям (например, "Почему это риск?").
6.  **Работа с документами (Мультимодальность):** Возможность загрузить сканы документов (договоры, счета), чтобы помощник проверил их на соответствие извлеченным реквизитам (например, проверил сумму в договоре с суммой в заявке)

## Технологии и подходы из курса

| Технология / Подход | Применение в проекте |
| :--- | :--- |
| **Работа с LLM через API** | Базовое взаимодействие с моделью (например, GPT-4) для всех текстовых задач: парсинг заявки, генерация рекомендаций, диалог. |
| **Structured Output** | 1. **Для парсинга заявки:** Получение от LLM структурированного JSON с полями `amount`, `cost_center`, `counterparty`, `reason`. <br> 2. **Для вывода рекомендаций:** Получение ответа в виде `{"risks": [...], "suggestions": [...], "checklist": [...]}` для последующей обработки. |
| **RAG (Retrieval-Augmented Generation)** | **Ядро системы.** Векторизация базы знаний исторических заявок и решений. При получении новой заявки будет выполняться семантический поиск по схожим кейсам, и найденные причины отклонений будут подаваться в LLM как контекст для генерации точных и релевантных рекомендаций. |
| **Агентные паттерны и LangGraph** | **Реализация сложного workflow.** <br> 1. **Graph State:** Отслеживание состояния заявки, истории диалога, извлеченных данных. <br> 2. **Ноды графа:** `parse_request` -> `search_similar_cases` -> `generate_recommendations` -> `check_documents` (если есть) -> `present_to_user`. <br> 3. **Условные переходы:** Например, если пользователь задал вопрос, перейти в ноду `handle_user_query`. |
| **Мультимодальность** | Использование Vision-моделей для анализа загруженных скан-копий документов. Например, проверка, что сумма в договоре совпадает с суммой в заявке, или поиск нужных реквизитов. |
| **MCP (Model Context Protocol)** | Интеграция с внешними системами банка. Например, через MCP-серверы: <br> 1. **Справочники:** Получение актуального списка статей затрат или подразделений. <br> 2. **Система документооборота:** Отправка готовой, проверенной заявки напрямую в систему согласования (например, BPMignite). |


##План развития проекта по темам курса

1.  **Неделя 1-2: Работа с LLM, Structured Output**
    *   **Цель:** Создать прототип, который принимает текстовую заявку и возвращает структурированный разбор (парсинг).
    *   **Результат:** Скрипт, который из текста вроде "Нужно списать 100т.р. на рекламу для отдела маркетинг" извлекает JSON: `{"amount": 100000, "department": "marketing", "type": "advertisement"}`.

2.  **Неделя 3-4: RAG**
    *   **Цель:** Научить систему искать релевантные кейсы.
    *   **Результат:** Векторная база (Chroma/Weaviate) на основе синтетических или реальных данных об исторических заявках. Прототип, который по разобранной заявке находит Top-3 похожих кейса и причины их отклонения.

3.  **Неделя 5-6: Агенты и LangGraph**
    *   **Цель:** Собрать весь пайплайн в единый управляемый workflow.
    *   **Результат:** LangGraph, который координирует парсинг, RAG-поиск и генерацию финальных рекомендаций. Добавление простого диалога для уточнений.

4.  **Неделя 7-8: Мультимодальность и MCP**
    *   **Цель:** Расширить функциональность.
    *   **Результат:**
        *   **Мультимодальность:** Добавление ноды в граф, которая, если пользователь загрузил изображение, вызывает Vision-модель для его анализа.
        *   **MCP:** Создание простого MCP-сервера (или подключение к mock-системе), который имитирует подключение к справочнику статей затрат банка.

5.  **Финальный проект**
    *   **Цель:** Интеграция всех компонентов, полировка UI/UX (простой веб-интерфейс на Streamlit/Gradio) и демонстрация работы полного цикла на реальных кейсах.
